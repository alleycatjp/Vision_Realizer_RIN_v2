# ========================================
# 📄 market_state.py - 市場状態分類ロジック（domain層）
# ----------------------------------------
# ■ 目的（ファイルの存在意義：詳細に）:
#   入力された価格データから、現在の市場状態を分類（trend / range / volatility / undecided）し、
#   状態に応じた戦術選定の土台情報として提供する。
#
# ■ 想定ユースケース（使用状況）:
#   application/bot.py から各銘柄に対して呼び出され、
#   市場状態に応じた戦術モジュールの切替判断に使用される。
#
# ■ 設計思想・背景:
#   複雑な条件分岐を避け、移動平均とボラティリティに基づく
#   シンプルかつ直感的な分類ロジックを採用。
#   各戦術（MACD・RSI・ATRなど）と自然に連携できるよう設計。
#
# ■ 実現機能（詳細に）:
#   - 短期・長期移動平均の傾きから「trend」判定
#   - ボラティリティ（標準偏差）から「volatility」判定
#   - 上記に該当しない場合は「range」または「undecided」に分類
#
# ■ 外部依存・前提:
#   - pandas.DataFrame を受け取り、20行以上の履歴が必要
#   - df["close"] カラムが存在すること
#
# ■ 主な処理フロー:
#   移動平均とボラティリティ計算 → 閾値による分類 → 状態文字列を返却
#
# ■ 注意点・構造補足:
#   - 閾値（slope, volatility）は現時点でハードコーディング
#   - market_config.json との閾値連動は未実装
#
# ■ 開発再開時のポイント:
#   - 閾値定義を設定ファイルへ移行し、柔軟な運用構造に対応予定
# ========================================
